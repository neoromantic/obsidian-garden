---
{"dg-publish":true,"permalink":"/4-arhiv/obsidian-unfinished/"}
---

Плагин для Obsidian, который позволяет пометить части документа как "незаконченные". 
Понадобилось мне в связке с [[1 - Проекты/02 - Личный сайт\|моим сайтом]], который я публикую с помощью [Digital Garden](https://github.com/oleeskild/obsidian-digital-garden), но потом я подумал, что у этого немного более широкое применение.

Я давно хотел научиться писать к Obsidian плагины, этот показался хорошим маленьким и полезным.

Репозиторий: [GitHub - neoromantic/obsidian-unfinished-plugin](https://github.com/neoromantic/obsidian-unfinished-plugin)

# Идеи
- некая разметка, которая позволяет пометить любые блоки как unfinished
- в edit mode они подсвечиваются иначе чем остальные
- в read mode их не видно 
- плагин работает вместе с Obsidian Publish и Digital Garden, делая так что они вырезают непубличные части
- позволять увидеть все незаконченные части (как-то интегрировать с dataview?), чтобы заняться их дописыванием
- команда (шорткат), который умеет по-умному переключать состояние, в том числе разделяя незавершенные блоки (если переключают только часть внутри незавершенного блока)
# Что надо сделать
- [x] Пройти [туториал](https://docs.obsidian.md/Plugins/Getting+started/Build+a+plugin) и собрать базовый плагин![Pasted image 20240225002404.png](/img/user/files/Pasted%20image%2020240225002404.png) ✅ 2024-02-25
	- [x] Установить [Hot Reload](https://github.com/pjeby/hot-reload), чтобы обсидиан перезагружал плагин во время разработки ✅ 2024-02-25
- [x] Придумать каким может быть маркер ✅ 2024-02-25
	- Можно начать с буквально любого, а потом разобраться
	- Он не должен конфликтовать с общепринятым маркдауном
	- Хорошо бы понятная семантика — например ~~тильды~~ используются для зачеркивания. Так может - три тильды?
		- Оказалось: три тильды в [расширенном Markdown](https://www.markdownguide.org/extended-syntax/) это code block. 
		- Поэтому рабочий вариант пока — !!!, а рабочая логика — попарная. То есть это и закрывающий и открывающий тег
		- Есть еще мысль про HTML типа `<hide>text</hide>`, можно попробовать и в эту сторону
		- Еще один вариант:  — это комментарий, он парсится как блок и автоматически исчезает в read mode. 
> [!danger] Вот тут-то пивот и случился
> Выяснилось, что этот синтаксис и есть то, что я хотел — можно обернуть любые блоки, он исчезает из read mode, и не публикуется никакими из плагинов. Очевидно, не надо ничего делать в свою сторону и если и дорабатывать, то этот механизм.
- [x] Реализовать скрытие в read mode ✅ 2024-02-25
	- Тут началась крольичья нора, потому что оказалось что надо учиться [писать плагины](https://codemirror.net/docs/ref/) для CodeMirror, и пока [ничерта не понятно](https://docs.obsidian.md/Plugins/Editor/View+plugins)
	- Успел разобраться частично, но Code Mirror это один из самых красноглазых проектов что я видел. Судя по всему - хороший, разумный, но только для настоящих программистов.
- [ ] Реализовать стилизацию в edit mode
	- [ ] Разрешить добавлять произвольный комментарий к скрытому блоку
	- [ ] Исправить работу с embed/iframe, комментарии не скрывают их
	- [ ] Изменить базовые стили — сейчас это повсеместный серый цвет, хочется менять только бекграунд, если это не-inline комментарий
- [x] Реализовать команду, которая может повеситься на шорткат ✅ 2024-02-25
	- Есть стандартный шорткат в Obsidian, переключающий комментарии
- [ ] Реализовать панель настроек плагина
	- [ ] Справочная информация для пользователя
- [x] Придумать как это интегрируется в Digital Garden ✅ 2024-02-25
- [x] Проверить работу плагина на мобилке ✅ 2024-02-25
```js
// Можно переключать десктоп-приложение в эмуляцию мобильного
this.app.emulateMobile(!this.app.isMobile);
```
- [ ] Обновить все названия, манифесты и описания
- [ ] Написать readme в репозитории
- [ ] Отправить первую версию плагина в официальный каталог

# Думалось попутно
- Прикольно было бы сделать публикацию документа из Obsidian в живом режиме: я пишу и это сразу обновляется у меня на сайте (если документ опубликован)

# Обсуждение в Твиттере
<blockquote class="twitter-tweet"><a href="https://twitter.com/user/status/1761440817150132665?ref_src=twsrc%5Etfw"></a></blockquote> <script async src="https://platform.twitter.com/widgets.js" charset="utf-8"></script>